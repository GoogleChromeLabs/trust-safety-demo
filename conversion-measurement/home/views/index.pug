doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title ⚡️ Demo: Event-Level Conversion Measurement API
  link(rel='stylesheet' href='/styles.css')
body
    h1 ⚡️ Demo: Event-Level Conversion Measurement API
    h2 Before you can run this demo
    ol
        li Make sure you're in Chrome, version 
            strong 86 
            | or later (for example 
            a(href='https://www.google.com/chrome/canary/' noreferrer noopener) Chrome Canary
            | ). You can check what version of Chrome you're using by typing 
            span.select.code chrome://version
            |  in the URL bar.
        li Go to flags by typing or pasting 
            span.select.code chrome://flags 
            | in Chrome's URL bar. 
            | Turn on the 
            strong two flags 
            span.select.code #enable-experimental-web-platform-features
            |  and 
            span.select.code #conversion-measurement-api
            |.
        li 
            strong Disable 
            | third-party cookie 
            strong blocking
            |. In the long term, dedicated browser settings will be available to allow/block the API. Until then, third-party cookie blocking is used as the signal that users don't want to share data about their conversions—and hence that this API should be disabled.
        li If you're running the demo locally (
            strong 127.0.0.1
            |), follow these 
            a(href='https://github.com/GoogleChromeLabs/trust-safety-demo/tree/main/conversion-measurement#browser-setup' noopener) additional instructions
            |.
    h2 Run the demo
    | Open these in new tabs:
    ul
        li 
            a(href=publisherUrl) Publisher website 📰 
        li
            a(href=adtechUrl) Adtech server 🚀 
        li
            span.select.code chrome://conversion-internals
            |  (type or paste in Chrome's URL bar)
    | And follow the steps indicated on each page.
    h2 See the code
    a(href="https://github.com/GoogleChromeLabs/trust-safety-demo/tree/main/conversion-measurement" noreferrer noopener) Code for this demo
    h2 Learn more
    ul
        li
            a(href="https://web.dev/TODO" noreferrer noopener) Article 
        li
            a(href="https://github.com/WICG/conversion-measurement-api" noreferrer noopener) API explainer 
    h2 Ask questions / Share feedback
    | 👋 Ping 
    a(href="https://twitter.com/maudnals" noreferrer noopener) @maudnals
    |  for feedback / questions about this demo.
    script.
        const okEls = document.querySelectorAll(".ok")
        const nokEls = document.querySelectorAll(".nok")
        const canDemoRun = document.featurePolicy.features().includes('conversion-measurement')
        if (canDemoRun) {
            okEls.forEach(el => {
                el.classList.add("show")
            });
            nokEls.forEach(el => {
                el.classList.add("hide")
            });
        } else {
            okEls.forEach(el => {
                el.classList.add("hide")
            });
            nokEls.forEach(el => {
                el.classList.add("show")
            });
        }