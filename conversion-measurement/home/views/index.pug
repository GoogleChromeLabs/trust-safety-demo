doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title âš¡ï¸ Demo: Event-Level Conversion Measurement API
  link(rel='stylesheet' href='/styles.css')
body
    h1 âš¡ï¸ Demo: Event-Level Conversion Measurement API
    h2.ok.success âœ… You're all set to run the demo.
    h2.nok.error âŒ You need to do this before you can run the demo:
    ul.nok
        li Make sure you're in Chrome, version 86 or later (for example 
            a(href='https://www.google.com/chrome/canary/' noreferrer noopener) Chrome Canary
            | ). You can check what version of Chrome you're using by typing 
            span.select.code chrome://version
            |  in the URL bar.
        li If you're running the demo locally (
            strong 127.0.0.1
            |): follow these 
            a(href='https://github.com/GoogleChromeLabs/trust-safety-demo/tree/main/conversion-measurement#browser-setup' noopener) additional instructions
            |.
    ul.ok
        li ðŸ†— Chrome 86 or later
        li ðŸ†— The feature is ON (via origin trial tokens or flags)
            span.select.code #enable-experimental-web-platform-features
            |  and 
            span.select.code #conversion-measurement-api
        | are on
        li ðŸ†— No third-party cookie blocking
    h2 Run the demo
    | Open these in new tabs:
    ul
        li 
            a(href=publisherUrl) Publisher website ðŸ“° 
        li
            a(href=adtechUrl) Adtech server ðŸš€ 
        li
            span.select.code chrome://conversion-internals
            |  (copy and paste in Chrome's URL bar)
    | And follow the steps indicated on each page.
    h2 See the code
    a(href="https://github.com/GoogleChromeLabs/trust-safety-demo/tree/main/conversion-measurement" noreferrer noopener) Code for this demo
    h2 Learn more
    ul
        li
            a(href="https://web.dev/TODO" noreferrer noopener) Article 
        li
            a(href="https://github.com/WICG/conversion-measurement-api" noreferrer noopener) API explainer 
    h2 Ask questions / Share feedback
    | ðŸ‘‹ Ping 
    a(href="https://twitter.com/maudnals" noreferrer noopener) @maudnals
    |  for feedback / questions about this demo.
    script.
        const okEls = document.querySelectorAll(".ok")
        const nokEls = document.querySelectorAll(".nok")
        const canDemoRun = document.featurePolicy.features().includes('conversion-measurement')
        if (canDemoRun) {
            okEls.forEach(el => {
                el.classList.add("show")
            });
            nokEls.forEach(el => {
                el.classList.add("hide")
            });
        } else {
            okEls.forEach(el => {
                el.classList.add("hide")
            });
            nokEls.forEach(el => {
                el.classList.add("show")
            });
        }